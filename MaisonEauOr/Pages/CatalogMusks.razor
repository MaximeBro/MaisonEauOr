@page "/catalogMusks"
@using MaisonEauOr.Models

@inject IDbContextFactory<MeoDbContext> Factory

<PageTitle>Maison eau d'or - Musc Tahara</PageTitle>

<MudStack Class="mt-10" Row>
    <MudSpacer />
    <MudButton Class="mr-16" Variant="Variant.Filled" StartIcon="@Icons.FilterAlt" Color="Color.Surface">Filtrer</MudButton>
</MudStack>

<MudGrid Class="px-6" Spacing="5" Justify="Justify.Center">
    @foreach (ProductModel muscTahara in muscTaharaList)
    {
        <MudItem Class="mt-5" Style="width:20%!important;" xs="12" sm="6" md="4" lg="3">
            <MudCard>
                <MudImage Src="@muscTahara.ImagePath" Alt="@muscTahara.Name" />
                <MudCardContent>
                    <MudText Align="Align.Center" Typo="Typo.h5"><b>@muscTahara.Name</b></MudText>
                    <MudText Align="Align.Center" Typo="Typo.body2">@muscTahara.Price</MudText>
                    </MudCardContent>
                    <MudCardActions Class="justify-center">
                        <MudButton Variant="Variant.Filled" Color="Color.Surface">Ajouter au panier</MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
    }
</MudGrid>

@code {
    private List<ProductModel> muscTaharaList = new List<ProductModel>();

    protected override async Task OnInitializedAsync()
    {
        _context = await Factory.CreateDbContextAsync();
        muscTaharaList = _context.Products.Where(x => x.Category == ProductCategory.MuscTahara).ToList();
        foreach (var product in muscTaharaList)
        {
            product.Options = _context.Options.Where(x => x.ProductID == product.Id).ToList();
        }
    }
    private MeoDbContext _context = null!;
}
