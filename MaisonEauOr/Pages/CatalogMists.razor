@page "/catalogmist"
@using MaisonEauOr.Models.Products

@inject IDbContextFactory<MeoDbContext> Factory

<PageTitle>Maison eau d'or - Brume</PageTitle>

<MudStack Class="mt-10" Row>
    <MudSpacer />
    <MudButton Class="mr-16" Variant="Variant.Filled" StartIcon="@Icons.FilterAlt" Color="Color.Surface">Filtrer</MudButton>
</MudStack>

<MudGrid Class="px-6" Spacing="5" Justify="Justify.Center">
    @foreach (Mist mist in mistList)
    {
        <MudItem Class="mt-5" Style="width:20%!important;" xs="12" sm="6" md="4" lg="3">
            <MudCard>
                <MudImage Src="@mist.ImagePath" Alt="@mist.Name" />
                <MudCardContent>
                    <MudText Align="Align.Center" Typo="Typo.h5"><b>@mist.Name</b></MudText>
                    <MudText Align="Align.Center" Typo="Typo.body2">@mist.Price</MudText>
                    </MudCardContent>
                    <MudCardActions Class="justify-center">
                        <MudButton Variant="Variant.Filled" Color="Color.Surface">Ajouter au panier</MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
    }
</MudGrid>

@code {
    private List<Mist> mistList = new List<Mist>();

    protected override async Task OnInitializedAsync()
    {
        _context = await Factory.CreateDbContextAsync();
        mistList = _context.Mists.Where(x => x.IsAvailable).ToList();
    }
    private MeoDbContext _context = null!;
}
